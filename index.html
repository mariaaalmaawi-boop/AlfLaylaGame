<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>كنوز ألف ليلة</title>
<style>
  body {
    background: #f5deb3; /* لون الصحراء */
    font-family: Arial, sans-serif;
  }

  #scoreBoard {
    text-align: center;
    font-size: 20px;
    margin-top: 10px;
  }

  #gameArea {
    width: 600px;
    height: 400px;
    background: url('https://i.imgur.com/3f6Aq3q.png') no-repeat center center;
    background-size: cover;
    position: relative;
    border: 2px solid #000;
    margin: 20px auto;
    overflow: hidden;
  }

  .player {
    width: 40px;
    height: 40px;
    background: red;
    position: absolute;
    top: 180px;
    left: 280px;
  }

  .treasure {
    width: 30px;
    height: 30px;
    background: gold;
    position: absolute;
  }

  .obstacle {
    width: 40px;
    height: 40px;
    background: purple;
    position: absolute;
  }
</style>
</head>
<body>

<div id="scoreBoard">نقاطك: 0 | حيواتك: 3</div>
<div id="gameArea">
  <div class="player" id="player"></div>
</div>

<script>
const player = document.getElementById('player');
const gameArea = document.getElementById('gameArea');
let score = 0;
let lives = 3;

// ضبط موقع البداية
player.style.top = '180px';
player.style.left = '280px';

// تحريك اللاعب
document.addEventListener('keydown', (e) => {
  const step = 10;
  let top = parseInt(player.style.top);
  let left = parseInt(player.style.left);

  if (e.key === 'ArrowUp') player.style.top = Math.max(0, top - step) + 'px';
  if (e.key === 'ArrowDown') player.style.top = Math.min(360, top + step) + 'px';
  if (e.key === 'ArrowLeft') player.style.left = Math.max(0, left - step) + 'px';
  if (e.key === 'ArrowRight') player.style.left = Math.min(560, left + step) + 'px';

  checkCollision();
});

// إضافة كنز عشوائي
function addTreasure() {
  const treasure = document.createElement('div');
  treasure.classList.add('treasure');
  treasure.style.top = Math.floor(Math.random() * 370) + 'px';
  treasure.style.left = Math.floor(Math.random() * 570) + 'px';
  gameArea.appendChild(treasure);
}
addTreasure();

// إنشاء عقبات تتحرك
const obstacles = [];
for (let i = 0; i < 3; i++) {
  const obs = document.createElement('div');
  obs.classList.add('obstacle');
  obs.style.top = Math.floor(Math.random() * 360) + 'px';
  obs.style.left = Math.floor(Math.random() * 560) + 'px';
  gameArea.appendChild(obs);
  obstacles.push({
    el: obs,
    dx: Math.random() > 0.5 ? 2 : -2,
    dy: Math.random() > 0.5 ? 2 : -2
  });
}

// تحريك العقبات
function moveObstacles() {
  obstacles.forEach(o => {
    let top = parseInt(o.el.style.top);
    let left = parseInt(o.el.style.left);

    top += o.dy;
    left += o.dx;

    if (top <= 0 || top >= 360) o.dy *= -1;
    if (left <= 0 || left >= 560) o.dx *= -1;

    o.el.style.top = top + 'px';
    o.el.style.left = left + 'px';

    // فحص التصادم مع اللاعب
    const pRect = player.getBoundingClientRect();
    const oRect = o.el.getBoundingClientRect();

    if (!(pRect.right < oRect.left || pRect.left > oRect.right ||
          pRect.bottom < oRect.top || pRect.top > oRect.bottom)) {
      lives--;
      resetPlayer();
      updateScore();
      if (lives <= 0) alert("انتهت اللعبة! نقاطك: " + score);
    }
  });
  requestAnimationFrame(moveObstacles);
}
moveObstacles();

// فحص التصادم مع الكنوز
function checkCollision() {
  const treasures = document.querySelectorAll('.treasure');
  treasures.forEach(t => {
    const tRect = t.getBoundingClientRect();
    const pRect = player.getBoundingClientRect();

    if (!(pRect.right < tRect.left || pRect.left > tRect.right ||
          pRect.bottom < tRect.top || pRect.top > tRect.bottom)) {
      score += 10;
      t.remove();
      addTreasure();
      updateScore();
    }
  });
}

// إعادة اللاعب إلى موقع البداية
function resetPlayer() {
  player.style.top = '180px';
  player.style.left = '280px';
}

// تحديث النقاط والحياة
function updateScore() {
  document.getElementById('scoreBoard').textContent = `نقاطك: ${score} | حيواتك: ${lives}`;
}
</script>

</body>
</html>
